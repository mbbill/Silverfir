Borrowed from the wasm3 project